<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Greeting Card</title>
<style>
  body { 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    margin: 16px; 
    background:#f8fafc; 
    color:#0f172a; 
  }
  .wrap { max-width: 900px; margin: 0 auto; text-align:center; }
  .controls { margin-bottom: 16px; }
  .controls input[type="text"] { 
    padding:10px 12px; 
    border:1px solid #cbd5e1; 
    border-radius: 8px; 
    width: 100%; 
    max-width: 300px; 
    font-size: 16px;
  }
  canvas { 
    width: 100%; 
    height: auto; 
    background: #e2e8f0; 
    border:1px solid #e5e7eb; 
    border-radius: 12px; 
    margin: 16px 0; 
  }
  .buttons { display:flex; justify-content:center; gap:12px; margin-top: 12px; }
  button { 
    padding:10px 16px; 
    border:0; 
    border-radius:8px; 
    cursor:pointer; 
    font-size: 15px;
  }
  .primary { background:#4f46e5; color:white; }
  .secondary { background:#e5e7eb; color:#111827; }
  .err { color:#b91c1c; font-size: 14px; margin-top: 8px; }
</style>
</head>
<body>
<div class="wrap">
  <h1>Greeting Card</h1>

  <!-- Name input -->
  <div class="controls">
    <input id="nameText" type="text" placeholder="Type a nameâ€¦" />
  </div>

  <!-- The card -->
  <canvas id="cardCanvas"></canvas>
  <p id="status" class="err"></p>

  <!-- Buttons below -->
  <div class="buttons">
    <button class="primary" id="renderBtn">Render</button>
    <button class="secondary" id="downloadBtn">Download PNG</button>
  </div>
</div>

<script>
  const nameInput = document.getElementById('nameText');
  const canvas = document.getElementById('cardCanvas');
  const ctx = canvas.getContext('2d');
  const statusEl = document.getElementById('status');

  // Defaults
  const defaults = {
    img: 'card.png', // must be in same folder as this HTML
    color: '#ffffff'
  };

  function loadImage(src) {
    return new Promise((resolve, reject) => {
      const img = new Image();
      img.onload = () => resolve(img);
      img.onerror = () => reject(new Error('Could not load ' + src + '. Make sure card.png is in the same folder (case-sensitive).'));
      img.src = src;
    });
  }

  async function draw() {
    statusEl.textContent = '';
    let img;
    try {
      img = await loadImage(defaults.img);
    } catch (e) {
      statusEl.textContent = e.message;
      return;
    }

    // Prepare canvas to match image size
    canvas.width = img.naturalWidth || img.width;
    canvas.height = img.naturalHeight || img.height;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    // Draw the name text centered near bottom
    const name = (nameInput.value || '').trim();
    if (name) {
      const size = Math.round(Math.min(canvas.width, canvas.height) * 0.12); // 10% of height
      const stroke = Math.max(2, Math.round(size * 0.04));
      ctx.save();
      ctx.textAlign = 'center';
      ctx.textBaseline = 'bottom';
      ctx.font = `700 ${size}px Poppins,Arial,Helvetica,sans-serif`;
      const centerX = canvas.width / 2;
      const baseY = canvas.height - (size * 0.3); // bottom with padding
      ctx.lineWidth = stroke;
      ctx.strokeStyle = 'rgba(0,0,0,0.65)';
      ctx.strokeText(name, centerX, baseY);
      ctx.fillStyle = defaults.color;
      ctx.fillText(name, centerX, baseY);
      ctx.restore();
    }
  }

  document.getElementById('renderBtn').addEventListener('click', draw);
  document.getElementById('downloadBtn').addEventListener('click', () => {
    const a = document.createElement('a');
    a.download = 'greeting.png';
    a.href = canvas.toDataURL('image/png');
    a.click();
  });

  // Auto render on load
  draw();
</script>
</body>
</html>